# GO

## GC

垃圾回收用来处理一些不用的内存空间，栈这种结构基本不需要用到，栈上垃圾很容易回收，而堆上的垃圾则需要垃圾回收机制进行回收。

#### * 引用计数算法

Python使用的就是这种垃圾回收的方式，使用一个rc来记录一个对象的被引用次数，如果引用次数归零，则我们认为这块内存为垃圾，进行回收。

```C
typedef struct_object {
    int ob_refcnt; // 引用计数
    struct_typeobject *ob_type;
}PyObject;
```

这种方法是高效的，并且不需要STW，但有个致命的弱点，就是循环引用，当变量间相互引用的时候，就会导致rc一直不为0，内存将得不到回收，Python并没有解决这种问题，而是使用了另外的遍历方式，从一个Root内存块开始，跟随其引用找出`可达`的对象，然后将`不可达`的对象销毁掉。


#### * 可达性分析算法

这种算法一般从一个Root内存块开始(栈上对象，全局对象)，通过这个Root内存块像下寻找，找出可达对象(可以访问到的)，剩下的则为不可达对象，需要进行回收。

当然这种方法也有缺点，无法并发执行GC，需要STW，并且当对象较多的时候，STW的时间是比较长的。

#### * 采用三色法的可达性分析

