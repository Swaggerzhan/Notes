# EPOLL

### 1. epoll事件参数

解释参数之前，先了解一下EPOLL的 __水平触发(level trigger)__ `LT`和 __边缘触发__ (edge trigger)`ET`。

区分两者比较明显的方式是

对于可读事件
* LT: 当一个fd文件描述符中存在数据，则 __持续触发。__
* ET: 当一个文件描述符中存在数据，则触发，如果后续没有继续进行处理，则不触发，直到 __文件描述符中的缓冲区变化后触发。__ 所以当一个文件描述符是ET方式的时候，应该循环将其缓冲区中的值读出，否则后续将不再触发，若将监听套接字设置为ET方式，在高并发的时候，可能会丢失某些链接，需要等到新客户链接才会继续触发，所以应当循环accpet知道accpet返回-1并且将errno设置为EAGAIN表示没有新连接。

事件参数具体解析：

* ### __EPOLLIN__ 

    文件描述符可读
* ### __EPOLLOUT__

    文件描述符可写
    

* ### __EPOLLHUP__


* ### __EPOLLRDHUP__

    在对端关闭 __读__ 时会被触发，这个事件应该优先处理
    
* ### __EPOLLONESHOT__

    只监听一次事件。
    
    如果存在以下例子，当一个fd发起请求时，服务器进行解析的同时，同样的fd又发来一个新事件，那么在多线程服务器中势必会分配另外一个线程来处理此事件，那么就会导致多个线程处理同一个fd的情况。为了避免这个条件，对一个fd设置事件`EPOLLONESHOT`就可以避免，当一个fd的事件处理完后在重新注册进epoll。
    